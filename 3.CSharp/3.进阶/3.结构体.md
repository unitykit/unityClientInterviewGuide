# 结构体

## 面试题

> 什么是结构体？
>
> **Unity 中的 Transform组件存储(位置、旋转、缩放)的信息是结构体还是类（对象）？**

在 C# 中，结构体（struct）是一种值类型（value type），用于组织和存储相关数据，一个单一变量可以存储各种数据类型的相关数据。

struct 关键字用于创建结构体。

结构提供了一种轻量级的数据类型，具有较好的性能特性和值语义：

1. 结构可带有方法、字段、索引、属性、运算符方法和事件，适用于表示轻量级数据的情况，如坐标、范围、日期、时间等。
2. 结构可定义构造函数，但不能定义析构函数。但是，您不能为结构定义无参构造函数。无参构造函数(默认)是自动定义的，且不能被改变。
3. 与类不同，结构不能继承其他的结构或类。
4. 结构不能作为其他结构或类的基础结构。
5. 结构可实现一个或多个接口。
6. 结构成员不能指定为 abstract、virtual 或 protected。
7. 当您使用 **New** 操作符创建一个结构对象时，会调用适当的构造函数来创建结构。与类不同，结构可以不使用 New 操作符即可被实例化。
8. 如果不使用 New 操作符，只有在所有的字段都被初始化之后，字段才被赋值，对象才被使用。
9. 结构变量通常分配在栈上，这使得它们的创建和销毁速度更快。但是，如果将结构用作类的字段，且这个类是引用类型，那么结构将存储在堆上。
10. 结构默认情况下是可变的，这意味着你可以修改它们的字段。但是，如果结构定义为只读，那么它的字段将是不可变的。

------

**Unity 中的 Transform组件存储的信息：Vector3（如位置、旋转、缩放）本质上是结构体（struct）:**

- **结构体的连续内存布局**：`Vector3`和`Quaternion`等结构体在内存中连续存储，符合CPU缓存行的对齐规则（通常64字节），可减少内存访问次数，提升数据读取效率
- **结构体的栈分配**：位置/旋转/缩放数据存储在栈上，避免了堆内存分配和垃圾回收（GC）压力

## 简单使用

```js
using System;
using System.Text;

struct Books
{
    public string title;
    public string author;
    public string subject;
    public int book_id;
};  

public class testStructure
{
    public static void Main(string[] args)
    {

        Books Book1;        /* 声明 Book1，类型为 Books */
        Books Book2;        /* 声明 Book2，类型为 Books */

        /* book 1 详述 */
        Book1.title = "C Programming";
        Book1.author = "Nuha Ali"; 
        Book1.subject = "C Programming Tutorial";
        Book1.book_id = 6495407;

        /* book 2 详述 */
        Book2.title = "Telecom Billing";
        Book2.author = "Zara Ali";
        Book2.subject =  "Telecom Billing Tutorial";
        Book2.book_id = 6495700;

        /* 打印 Book1 信息 */
        Console.WriteLine( "Book 1 title : {0}", Book1.title);
        Console.WriteLine("Book 1 author : {0}", Book1.author);
        Console.WriteLine("Book 1 subject : {0}", Book1.subject);
        Console.WriteLine("Book 1 book_id :{0}", Book1.book_id);

        /* 打印 Book2 信息 */
        Console.WriteLine("Book 2 title : {0}", Book2.title);
        Console.WriteLine("Book 2 author : {0}", Book2.author);
        Console.WriteLine("Book 2 subject : {0}", Book2.subject);
        Console.WriteLine("Book 2 book_id : {0}", Book2.book_id);       

        Console.ReadKey();

    }
}
```

Book 1 title : C Programming

Book 1 author : Nuha Ali

Book 1 subject : C Programming Tutorial

Book 1 book_id : 6495407

Book 2 title : Telecom Billing

Book 2 author : Zara Ali

Book 2 subject : Telecom Billing Tutorial

Book 2 book_id : 6495700
