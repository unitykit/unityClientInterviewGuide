# 事件

## 事件（Event）

*C*# 事件（Event）是一种成员，用于将特定的事件通知发送给订阅者。事件通常用于实现观察者模式，它允许一个对象将状态的变化通知其他对象，而不需要知道这些对象的细节。

**delegate** 相当于定义一个函数类型。

**event** 相当于定义一个 **delegate** 的函数指针（回调函数指针）。

这样就好理解了。

**事件（Event）** 基本上说是一个用户操作，如按键、点击、鼠标移动等等，或者是一些提示信息，如系统生成的通知。应用程序需要在事件发生时响应事件。例如，中断。C# 中也可以使用事件机制实现线程间的通信。

**使用流程：**

- **声明委托**：定义事件将使用的委托类型。委托是一个函数签名。
- **声明事件**：使用 `event` 关键字声明一个事件。
- **触发事件**：在适当的时候调用事件，通知所有订阅者。
- **订阅和取消订阅事件**：其他类可以通过 `+=` 和 `-=` 运算符订阅和取消订阅事件。

## 通过事件使用委托

事件在类中声明且生成，且通过使用同一个类或其他类中的委托与事件处理程序关联。包含事件的类用于发布事件。这被称为 **发布器（publisher）** 类。其他接受该事件的类被称为 **订阅器（subscriber）** 类。

事件使用 **发布-订阅（publisher-subscriber）** 模型。

**发布器（publisher）** 是一个包含事件和委托定义的对象。事件和委托之间的联系也定义在这个对象中。发布器（publisher）类的对象调用这个事件，并通知其他的对象。

**订阅器（subscriber）** 是一个接受事件并提供事件处理程序的对象。在发布器（publisher）类中的委托调用订阅器（subscriber）类中的方法（事件处理程序）。

## 事件的运用总结

事件的整个过程是：**订阅 -> 发布 -> 执行**。

-  **订阅**: 假设事件 A 的执行方法是 F_A，事件 B 的执行方法是 F_B，将这些事件与它们的**委托人**进行绑的行为就是订阅，这个**委托人**就是发布器的一个成员。订阅器另一个行为就是在订阅之后（必学先订阅）通知发布器的相关成员。
-  **发布**： 首先要明确事件发布的类型（由事件的执行方法参数列表决定）和要发布事件的变量（这个变量即委托人）；其次整理发布所需的材料、判断条件是否合适等；最后让内部的**委托人**向执行函数传递最终信息。
-  **执行**： 是整个事件最后完成的步骤，就是普通的函数。

## 再次理解

事件是拥有可以注册和解绑方法（函数）的功能。

虽然事件和委托看起来有点绕，只要捋清楚事件和委托的关系，就会很容易理解。

委托是一个类，事件则是委托类中的一个对象，该对象是能够把其他方法注册到委托类中的一个事件（如果觉得有点绕，可以忽略这句话）。

事件和函数的关系：事件具有可以注册多个函数（和解绑函数）的功能，而函数如果要注册和解绑其他在其主体上运行的函数则需要改动该函数本体的代码，这就是区别。

以下代码的大致流程：定义一个新类（事件类）--》类中声明委托--》由委托类又声明事件--》再定义触发事件的函数--》函数主体中执行事件--》在主函数中实例化事件类--》进而调用事件类中的事件对象--》事件对象再注册（+=）两个方法--》再执行事件类中触发事件的那个函数--》再解绑其中一个方法--》再次执行事件类中触发事件的函数。

由此可见：事件是拥有可以注册和解绑方法（函数）的功能。
